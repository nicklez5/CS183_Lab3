#!/bin/bash
hiecho "Find all files in /bin, /sbin, /usr/bin and /usr/sbin that are setuid and owned by root"
echo "Files that are setuid by root"
list="$(find /bin /sbin /usr/bin /usr/sbin -user root -perm -4000 -exec ls -ldb {} \; > /tmp/bin1)"
echo "$list"
list_cmd="$(cat /tmp/bin1)"
echo "$list_cmd"
read -p "Hit any key to continue."
echo "Files that are owned by root"
list="$(find /bin /sbin /usr/bin /usr/sbin -user root > /tmp/bin2)"
echo "$list"
list_cmd2="$(cat /tmp/bin2)"
echo "$list_cmd2"
echo "Find all files across the entire system that have setuid or setgid enabled"
read -p "Hit any key to continue."
list="$(find / -user root -perm -4000 -exec ls -ldb {} \; > /tmp/bin3)"
echo "$list"
list_cmd2="$(cat /tmp/bin3)"
echo "$list_cmd2"
echo "Find all files in /var that have changed in the last 20 minutes"
read -p "Hit any key to continue." 
list="$(find /var -type f -mmin -20)"
echo "$list"
echo "Find all files in /var that are regular files of zero length"
read -p "Hit any key to continue." 
list="$(find /var -size 0)"
echo "$list"
echo "Find all files in /dev that are not regular files and also not directories"
read -p "Hit any key to continue."
list="$(find /dev \( -not -type f -not -type d \) | xargs stat)"
echo "$list"
echo "Find all directories in /home that are not owned by root and change their permissions to 711(-rwx--xx--x)"
read -p "Hit any key to continue."
list="$(find /home -type d ! -user root | chmod 711 /home/jlu080)"
echo "$list"
echo "Find all regular files in /home that are not owned by root and change their permissions to 755(-rwxr-xr-x)"
read -p "Hit any key to continue."
list="$(find /home -type f ! -user root | chmod 755 /home/jlu080)"
echo "$list"
echo "Find all files (of all types) in /etc that have changed in the last 5 days"
read -p "Hit any key to continue."
list="$(find /etc -type f -mtime -5)"
echo "$list"

